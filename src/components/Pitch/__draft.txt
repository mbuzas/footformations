import React, { useState } from 'react'
import './Pitch.css'

const Pitch = () => {

    const [ObjectMap, setObjectMap] = useState([])
    // const [positionX, setPositionX] = useState(0)
    // const [positionY, setPositionY] = useState(0)
    const randNum = Math.floor(Math.random() * 100)

    const [players, setPlayers] = useState([
        (
            <div

                className='futboliukas'
                draggable="true"
                style={{ top: 261 + "px", left: 570 + 'px' }}
                onDragStart={drag}
                id={randNum}
                onDragEnd={e => {
                    DragTask(e);
                }}
            ></div>),
        (
            <div

                className='futboliukas'
                draggable="true"
                style={{ top: 261 + "px", left: 570 + 'px' }}
                onDragStart={drag}
                id={randNum}
                onDragEnd={e => {
                    DragTask(e);
                }}
            ></div>),
    ])

    const createCircle = () => {
        let coordinates = {
            top: 0,
            left: 0
        };
        let styleObject = Object.assign({}, coordinates);

        return (
            <div
                style={styleObject}
                className='futboliukas'
                draggable="true"
                style={{ top: 261 + "px", left: 570 + 'px' }}
                onDragStart={drag}
                id={randNum}
                onDragEnd={e => {
                    DragTask(e);
                }}
            ></div>)
    }

    const CreateObject = (object) => {
        let NewObject = ObjectMap;
        NewObject.push(object);
        setObjectMap([NewObject]);
    };
    const CreateBox = (style) => {
        let object = {
            top: 0,
            left: 0
        };
        let styleObject = Object.assign({}, object, style);
        return (
            <div
                style={styleObject}
                className='futboliukas'
                draggable="true"
                style={{ top: 261 + "px", left: 570 + 'px' }}
                onDragStart={drag}
                id={randNum}
                onDragEnd={e => {
                    DragTask(e);
                }}
            ></div>
        );
    };
    const DragTask = (e) => {
        e.target.style.top = e.clientY + "px";
        e.target.style.left = (e.clientX) + "px";
    };
    const CreateOneBox = () => {
        CreateObject(
            CreateBox({

            })
        );
    };

    function onDrop(ev) {
        ev.preventDefault();
        var id = ev.dataTransfer.getData("text");
        const draggableElement = document.getElementById(id);
        const dropzone = ev.target;
        dropzone.appendChild(draggableElement);
        ev.dataTransfer.clearData();
    }

    function allowDrop(ev) {
        ev.preventDefault();
    }

    function drag(ev) {
        ev.dataTransfer.setData("text", ev.target.id);
    }

    // Kadangi clientX ir clientY neveikia kaip turėtų, ir rodo iš tikro viso lango koordinates, tai
    // Bandžiau su ref pasiimti 'pitch' bloko koordinates, bet nelabai nepavyko.

    const logCoordinates = (e) => {
        console.log(e.clientX, e.clientY);
        // inputRef.getBoundingClientRect()
        // const esamos = e.getBoundingClientRect();
        // const x = esamos.x;
        // const y = esamos.y;
        // console.log(x, y);

    }
    // const getTopCoordinate = (el) => {
    //     const topCoordinate = el.getBoundingClientRect().left
    //     console.log(topCoordinate);
    // }



    return (
        <div className='pitch' onClick={logCoordinates}>
            <h3>Pitch</h3>
            <div
                className='futboliukas'
                draggable="true"
                onDragStart={drag}
                id={randNum}
                onDragEnd={e => { DragTask(e) }}
            > 5.<p>Buzas</p></div>


            {
                players.map((item, index) => {
                    return item;
                })
            }
            <div className="pitch-block" onDragOver={allowDrop} onDrop={onDrop} >

            </div>
            <button type="button" onClick={createCircle}>
                Create Circle!
            </button>
        </div >
    )
}

export default Pitch
